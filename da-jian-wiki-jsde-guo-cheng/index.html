<!doctype html><html lang=zh-CN><head><meta content="public, max-age=31536000" http-equiv=Cache-Control><meta content=public http-equiv=Pragma><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="text/html; charset=utf-8" http-equiv=content-type><meta content="width=device-width,initial-scale=1.0,maximum-scale=1,viewport-fit=cover" name=viewport><title>Zerobiubiu</title><link href=https://zerobiubiu.top/print.css media=print rel=stylesheet><link href=https://zerobiubiu.top/poole.css rel=stylesheet><link href=https://zerobiubiu.top/hyde.css rel=stylesheet><link href="https://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface" rel=stylesheet><link href=https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css rel=stylesheet><link sizes="16x16 32x32 64x64" href=https://zerobiubiu.top/img/logo.png rel=icon><body><div class=sidebar><div class="container sidebar-sticky"><div class=sidebar-about><a href=https://zerobiubiu.top> <img alt=logo class=logo src=https://zerobiubiu.top/img/logo.png> <h1>Zerobiubiu</h1> </a><p class=lead>我的博客</div><ul class=sidebar-nav><li class=sidebar-nav-item><a href=https://github.com/zerobiubiu target=_blank><i class="bi bi-github">Github</i></a><li class=sidebar-nav-item><a href=/about target=_blank><i class="bi bi-file-person">About</i></a></ul></div></div><div class="content container"><div class=post><h1 class=post-title>搭建Wiki.js的过程</h1><span class=post-date>2022-05-03 19:55:41</span><blockquote><p>Wiki.js官网自称最为强大的和可扩展的开源Wiki软件 可以采用多种方式编写Wiki，支持常用的markdown、HTML等</blockquote><span id=continue-reading></span><h2 id=information-source-xu>ℹ️ 序</h2><p>为了让我写的文档能够方便的访问和查看，之前用docsify生成的静态页面，放在GitHub pages托管，现在感觉结构太缺乏，不是很能满足现在的需求（心理需求），决定还是切换到Wiki.js了<blockquote><p>设备：云服务器1核2G 系统：Debian10.10 数据库：MySQL8.0</blockquote><h2 id=new-an-zhuang>🆕 安装</h2><blockquote><p>崩溃了，快写完了，保存测试，数据丢了，内容只剩这儿了😭 2022年5月4日12点48分，重写</blockquote><p>进到<a href=https://js.wiki/ rel=noopener target=_blank>官网</a>，右上角点<code>Get Started</code>按钮，选择2.x <code>Setup Instructions</code>，就能看到官方的安装教程，根据系统选择就好。<p>Wiki.js支持 MySQL, MariaDB, PostgreSQL, MSSQL、SQLite3数据库 官方教程用到的是SQLite3，但是我用的MySQL。 MySQL数据库的配置可以看<a href=../debian1010-zhuang-mysql>这篇</a><p>下载官方包，wget，curl都可以。<pre class=language-bash data-lang=bash style=color:#c0c5ce;background-color:#2b303b><code class=language-bash data-lang=bash><span style=color:#bf616a>wget</span><span> https://github.com/Requarks/wiki/releases/latest/download/wiki-js.tar.gz
</span></code></pre><pre class=language-bash data-lang=bash style=color:#c0c5ce;background-color:#2b303b><code class=language-bash data-lang=bash><span style=color:#bf616a>curl</span><span> https://github.com/Requarks/wiki/releases/latest/download/wiki-js.tar.gz
</span></code></pre><p>提取内容<pre class=language-bash data-lang=bash style=color:#c0c5ce;background-color:#2b303b><code class=language-bash data-lang=bash><span style=color:#bf616a>mkdir</span><span> wiki
</span><span style=color:#bf616a>tar</span><span> xzf wiki-js.tar.gz</span><span style=color:#bf616a> -C</span><span> ./wiki
</span><span style=color:#96b5b4>cd</span><span> ./wiki
</span></code></pre><p>内置一个配置模板，拿来用就好<pre class=language-bash data-lang=bash style=color:#c0c5ce;background-color:#2b303b><code class=language-bash data-lang=bash><span style=color:#bf616a>mv</span><span> config.sample.yml config.yml
</span></code></pre><p>更改配置文件：用编辑器打开，我习惯VIM<pre class=language-bash data-lang=bash style=color:#c0c5ce;background-color:#2b303b><code class=language-bash data-lang=bash><span style=color:#bf616a>vim</span><span> config.yml
</span></code></pre><p>进去只需要注意几个关键配置，其他的不需要在意。 <img alt decoding=async loading=lazy src=/post-images/1651640483333.PNG><ol><li>port：这是服务器启动的端口<li>db： <ol><li>type：数据库类型，我用的MySQL，可自行选择，<li>host：服务器的地址，本机的话127.0.0.1或者localhost<li>port：数据库的端口，MySQL默认3306<li>user：数据库用户，没什么注意的话就填root<li>pass：数据库用户密码<li>db：数据库名，一定要提前创建好，不然启动会出错。 <blockquote><p>创建数据库的命令<code>CREATE DATABASE 数据库名;</code></blockquote></ol></ol><h2>⏯ 启动</h2><p>Wiki.js是基于Node.js开发的，启动要用到 Node.js10.12 以上，推荐用最新的LTS版本就好，v16LTS可以启动，但是v18启动会报错。<p>Node.js安装、版本管理可以通过NVM工具，NVM的操作可以看<a href=http://zerobiubiu.top/zh/NVM rel=noopener target=_blank>我的Wiki-NVM</a><p>做好上边的配置就可以启动了，启动命令<pre class=language-bash data-lang=bash style=color:#c0c5ce;background-color:#2b303b><code class=language-bash data-lang=bash><span style=color:#bf616a>node</span><span> server
</span></code></pre><p>出现这个界面就代表成功了，访问你的IP加你设置的端口就可以访问了 <img alt decoding=async loading=lazy src=/post-images/1651641842713.PNG><p>但是，启动后会占用掉终端，尤其是SSH连接欸，一旦断开服务器就停止运行了，所以要采取办法让他在后台保持运行<p>nohup，将程序以忽略挂起信号的方式运行起来<pre class=language-bash data-lang=bash style=color:#c0c5ce;background-color:#2b303b><code class=language-bash data-lang=bash><span style=color:#bf616a>nohub</span><span> node server &
</span></code></pre><p>服务器就会在后台运行，同时将执行日志输出到nohup.out的文件中，除非另外指定了输出文件<pre class=language-bash data-lang=bash style=color:#c0c5ce;background-color:#2b303b><code class=language-bash data-lang=bash><span style=color:#bf616a>nohup</span><span> node server > your_out.file </span><span style=color:#d08770>2</span><span>>&</span><span style=color:#d08770>1 </span><span>&
</span></code></pre><p>当我们不想用的时候，可以杀掉程序进程<ol><li>查看进程：<pre class=language-bash data-lang=bash style=color:#c0c5ce;background-color:#2b303b><code class=language-bash data-lang=bash><span style=color:#bf616a>ps -ef </span><span>| </span><span style=color:#bf616a>grep </span><span>"</span><span style=color:#a3be8c>node server</span><span>"
</span></code></pre><li>杀死进程<pre class=language-bash data-lang=bash style=color:#c0c5ce;background-color:#2b303b><code class=language-bash data-lang=bash><span style=color:#96b5b4>kill</span><span> -9 查看进程查到的pid
</span></code></pre></ol><p>至此，安装结束</div></div>